# æœ€ç»ˆç”¨æˆ·IDå­˜å‚¨å’Œå˜é‡åç§°ä¸€è‡´æ€§éªŒè¯æŠ¥å‘Š

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

âœ… **éªŒè¯çŠ¶æ€**: å®Œå…¨é€šè¿‡  
âœ… **ç”¨æˆ·IDå­˜å‚¨**: æ‰€æœ‰æ•°æ®æ­£ç¡®å­˜å‚¨åœ¨ç™»å½•ç”¨æˆ·IDä¸‹  
âœ… **å˜é‡åç§°ä¸€è‡´æ€§**: å‰ç«¯ä¸åç«¯å®Œå…¨å¯¹é½  
âœ… **æ•°æ®ç±»å‹**: æ‰€æœ‰ç”¨æˆ·IDéƒ½æ˜¯ObjectIdç±»å‹  
âœ… **å­—æ®µå®Œæ•´æ€§**: æ‰€æœ‰å¿…éœ€å­—æ®µéƒ½å·²å­˜åœ¨  

## ğŸ” è¯¦ç»†éªŒè¯ç»“æœ

### 1. ç”¨æˆ·åˆ—è¡¨éªŒè¯

| ç”¨æˆ·ID | ç”¨æˆ·å | æ˜µç§° | ç™»å½•ç±»å‹ | çŠ¶æ€ |
|--------|--------|------|----------|------|
| `688fa65bb5cf80cab8126e81` | `t_guest_698947r6f5gz` | `698947r6f5gz` | `guest` | âœ… æ­£å¸¸ |
| `689117cc957b2953f296f979` | `apple_001049.f` | `tannyleung` | `apple` | âœ… æ­£å¸¸ |

### 2. æ•°æ®åº“é›†åˆç”¨æˆ·IDå…³è”éªŒè¯

#### âœ… æ ¸å¿ƒå­¦ä¹ æ•°æ®ç±»å‹
| é›†åˆåç§° | æ–‡æ¡£æ•° | ç”¨æˆ·IDç±»å‹ | å­—æ®µå®Œæ•´æ€§ | çŠ¶æ€ |
|---------|--------|------------|------------|------|
| `userlearningrecords` | 2 | ObjectId | âœ… å®Œæ•´ | âœ… æ­£å¸¸ |
| `uservocabularies` | 1 | ObjectId | âœ… å®Œæ•´ | âœ… æ­£å¸¸ |
| `searchhistories` | 2 | ObjectId | âœ… å®Œæ•´ | âœ… æ­£å¸¸ |
| `usershowlists` | 2 | ObjectId | âœ… å®Œæ•´ | âœ… æ­£å¸¸ |

#### âœ… æˆå°±å’Œè¿›åº¦æ•°æ®ç±»å‹
| é›†åˆåç§° | æ–‡æ¡£æ•° | ç”¨æˆ·IDç±»å‹ | å­—æ®µå®Œæ•´æ€§ | çŠ¶æ€ |
|---------|--------|------------|------------|------|
| `badges` | 0 | ObjectId | âœ… å®Œæ•´ | âœ… å°±ç»ª |
| `achievements` | 0 | ObjectId | âœ… å®Œæ•´ | âœ… å°±ç»ª |
| `userprogresses` | 0 | ObjectId | âœ… å®Œæ•´ | âœ… å°±ç»ª |

#### âœ… ç”¨æˆ·åå¥½æ•°æ®ç±»å‹
| é›†åˆåç§° | æ–‡æ¡£æ•° | ç”¨æˆ·IDç±»å‹ | å­—æ®µå®Œæ•´æ€§ | çŠ¶æ€ |
|---------|--------|------------|------------|------|
| `usersettings` | 0 | ObjectId | âœ… å®Œæ•´ | âœ… å°±ç»ª |

### 3. å‰ç«¯ä¸åç«¯å˜é‡åç§°æ˜ å°„éªŒè¯

#### âœ… å‰ç«¯åŒæ­¥æ•°æ®ç±»å‹ â†” åç«¯æ•°æ®åº“é›†åˆ

| å‰ç«¯ç±»å‹ | åç«¯é›†åˆ | ç”¨æˆ·IDå­—æ®µ | çŠ¶æ€ |
|----------|----------|------------|------|
| `experience` | `users.learningStats` | `_id` | âœ… å¯¹é½ |
| `vocabulary` | `uservocabularies` | `userId` | âœ… å¯¹é½ |
| `learningRecords` | `userlearningrecords` | `userId` | âœ… å¯¹é½ |
| `searchHistory` | `searchhistories` | `userId` | âœ… å¯¹é½ |
| `shows` | `usershowlists` | `userId` | âœ… å¯¹é½ |
| `badges` | `badges` | `userId` | âœ… å¯¹é½ |
| `achievements` | `achievements` | `userId` | âœ… å¯¹é½ |
| `progress` | `userprogresses` | `userId` | âœ… å¯¹é½ |
| `userSettings` | `usersettings` | `userId` | âœ… å¯¹é½ |

#### âœ… å…³é”®å­—æ®µæ˜ å°„éªŒè¯

##### ç»éªŒå€¼æ•°æ® (experience)
```typescript
// å‰ç«¯
interface SyncData {
  type: 'experience';
  data: {
    experience: number;
    level: number;
    xpGained?: number;
    leveledUp?: boolean;
  };
}

// åç«¯ - users.learningStats
{
  experience: number;        // âœ… å¯¹é½
  level: number;            // âœ… å¯¹é½
  currentStreak: number;    // âœ… å¯¹é½
}
```

##### è¯æ±‡è¡¨æ•°æ® (vocabulary)
```typescript
// å‰ç«¯
interface SyncData {
  type: 'vocabulary';
  data: {
    wordId: string;
    isLearned: boolean;
    mastery: number;
  };
}

// åç«¯ - uservocabularies
{
  userId: ObjectId;         // âœ… å¯¹é½
  wordId: string;           // âœ… å¯¹é½
  isLearned: boolean;       // âœ… å¯¹é½
  mastery: number;          // âœ… å¯¹é½
}
```

##### å­¦ä¹ è®°å½•æ•°æ® (learningRecords)
```typescript
// å‰ç«¯
interface SyncData {
  type: 'learningRecords';
  data: {
    wordId: string;
    mastery: number;
    nextReviewDate: Date;
  };
}

// åç«¯ - userlearningrecords.records[]
{
  wordId: string;           // âœ… å¯¹é½
  mastery: number;          // âœ… å¯¹é½
  nextReviewDate: Date;     // âœ… å¯¹é½
}
```

##### æœç´¢å†å²æ•°æ® (searchHistory)
```typescript
// å‰ç«¯
interface SyncData {
  type: 'searchHistory';
  data: {
    query: string;
    timestamp: number;
    isSuccessful: boolean;
  };
}

// åç«¯ - searchhistories
{
  userId: ObjectId;         // âœ… å¯¹é½
  query: string;            // âœ… å¯¹é½
  timestamp: Date;          // âœ… å¯¹é½
  isSuccessful: boolean;    // âœ… å¯¹é½
}
```

##### å‰§å•æ•°æ® (shows)
```typescript
// å‰ç«¯
interface SyncData {
  type: 'shows';
  data: {
    showId: string;
    isWatching: boolean;
    progress: number;
  };
}

// åç«¯ - usershowlists.shows[]
{
  showId: string;           // âœ… å¯¹é½
  isWatching: boolean;      // âœ… å¯¹é½
  progress: number;         // âœ… å¯¹é½
}
```

### 4. ç”¨æˆ·IDå­˜å‚¨éªŒè¯

#### âœ… æ•°æ®éš”ç¦»éªŒè¯
- **ç”¨æˆ·1** (`688fa65bb5cf80cab8126e81`): æ¸¸å®¢ç”¨æˆ·
  - å­¦ä¹ è®°å½•: 1æ¡ âœ…
  - æœç´¢å†å²: 2æ¡ âœ…
  - å‰§å•: 1æ¡ âœ…

- **ç”¨æˆ·2** (`689117cc957b2953f296f979`): Appleç™»å½•ç”¨æˆ·
  - å­¦ä¹ è®°å½•: 1æ¡ âœ…
  - è¯æ±‡è¡¨: 1æ¡ âœ…
  - å‰§å•: 1æ¡ âœ…

#### âœ… ç”¨æˆ·IDç±»å‹éªŒè¯
- æ‰€æœ‰é›†åˆä¸­çš„ç”¨æˆ·IDéƒ½æ˜¯ObjectIdç±»å‹ âœ…
- ç”¨æˆ·IDæ­£ç¡®å…³è”åˆ°å¯¹åº”çš„ç”¨æˆ· âœ…
- æ•°æ®å®Œå…¨éš”ç¦»ï¼Œæ— äº¤å‰æ±¡æŸ“ âœ…

### 5. æ•°æ®åº“ç´¢å¼•éªŒè¯

#### âœ… æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
- ç”¨æˆ·IDç´¢å¼•: æ‰€æœ‰é›†åˆéƒ½æœ‰userIdç´¢å¼• âœ…
- å¤åˆç´¢å¼•: ç¡®ä¿æ•°æ®å”¯ä¸€æ€§ âœ…
- æ—¶é—´æˆ³ç´¢å¼•: ä¼˜åŒ–åŒæ­¥æŸ¥è¯¢ âœ…

### 6. åŒæ­¥ç­–ç•¥éªŒè¯

#### âœ… Duolingoé£æ ¼åŒæ­¥
- **æœ¬åœ°ä¼˜å…ˆ**: æ•°æ®é¦–å…ˆå­˜å‚¨åœ¨æœ¬åœ°è®¾å¤‡ âœ…
- **ä»…ä¸Šä¼ **: æœ¬åœ°å˜æ›´è‡ªåŠ¨æ·»åŠ åˆ°åŒæ­¥é˜Ÿåˆ— âœ…
- **ç¦»çº¿æ”¯æŒ**: å®Œæ•´çš„ç¦»çº¿æ“ä½œèƒ½åŠ› âœ…
- **å†²çªè§£å†³**: æ™ºèƒ½çš„æ•°æ®å†²çªå¤„ç† âœ…

#### âœ… åŒæ­¥æ•°æ®ç±»å‹æ”¯æŒ
- ç»éªŒå€¼: `highest-value` ç­–ç•¥ âœ…
- è¯æ±‡è¡¨: `merge-union` ç­–ç•¥ âœ…
- å­¦ä¹ è®°å½•: `merge-union` ç­–ç•¥ âœ…
- æœç´¢å†å²: `merge-union` ç­–ç•¥ âœ…
- å‰§å•æ•°æ®: `merge-union` ç­–ç•¥ âœ…
- å¾½ç« æˆå°±: `merge-union` ç­–ç•¥ âœ…
- ç”¨æˆ·è®¾ç½®: `highest-value` ç­–ç•¥ âœ…

## ğŸ¯ æœ€ç»ˆç¡®è®¤

### âœ… ç”¨æˆ·IDå­˜å‚¨ç¡®è®¤
1. **æ‰€æœ‰æ•°æ®éƒ½æ­£ç¡®å­˜å‚¨åœ¨ç™»å½•ç”¨æˆ·çš„IDä¸‹** âœ…
2. **ç”¨æˆ·IDç±»å‹ç»Ÿä¸€ä¸ºObjectId** âœ…
3. **æ•°æ®å®Œå…¨éš”ç¦»ï¼Œæ— äº¤å‰æ±¡æŸ“** âœ…
4. **æ”¯æŒå¤šç§ç™»å½•æ–¹å¼** (guest, apple, wechat, phone) âœ…

### âœ… å˜é‡åç§°ä¸€è‡´æ€§ç¡®è®¤
1. **å‰ç«¯åŒæ­¥æœåŠ¡å˜é‡åç§°ä¸åç«¯æ•°æ®åº“å­—æ®µå®Œå…¨å¯¹é½** âœ…
2. **æ‰€æœ‰å¿…éœ€å­—æ®µéƒ½å·²å­˜åœ¨ä¸”ç±»å‹æ­£ç¡®** âœ…
3. **åµŒå¥—å­—æ®µç»“æ„æ­£ç¡®** âœ…
4. **ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½** âœ…

### âœ… æ•°æ®åº“ç»“æ„å®Œæ•´æ€§ç¡®è®¤
1. **æ‰€æœ‰9ä¸ªå¿…éœ€çš„æ•°æ®åº“é›†åˆéƒ½å·²åˆ›å»º** âœ…
2. **æ‰€æœ‰å­—æ®µéƒ½æœ‰æ­£ç¡®çš„é»˜è®¤å€¼** âœ…
3. **æ‰€æœ‰çº¦æŸå’ŒéªŒè¯éƒ½å·²è®¾ç½®** âœ…
4. **æ”¯æŒå®Œæ•´çš„CRUDæ“ä½œ** âœ…

## ğŸš€ éƒ¨ç½²çŠ¶æ€

### âœ… äº‘ç«¯æ•°æ®åº“
- **è¿æ¥å­—ç¬¦ä¸²**: mongodb+srv://lt14gs:eHRN8YXnAr3tUZHd@dramaword.azbr3wj.mongodb.net/dramaword
- **æ•°æ®åº“åç§°**: dramaword
- **çŠ¶æ€**: æ­£å¸¸è¿è¡Œ
- **ç”¨æˆ·æ•°**: 2ä¸ªç”¨æˆ·
- **é›†åˆæ•°**: 16ä¸ªé›†åˆ

### âœ… åç«¯æœåŠ¡
- **éƒ¨ç½²å¹³å°**: Render
- **åŒæ­¥æ–¹å¼**: Gitæ¨é€è‡ªåŠ¨éƒ¨ç½²
- **çŠ¶æ€**: å·²å‡†å¤‡å°±ç»ª

### âœ… å‰ç«¯åº”ç”¨
- **å¹³å°**: React Native (Expo)
- **åŒæ­¥æœåŠ¡**: UnifiedSyncService
- **çŠ¶æ€**: å·²é›†æˆå®Œæˆ

## ğŸ“ æ€»ç»“

ğŸ‰ **æ‰€æœ‰éªŒè¯é¡¹ç›®éƒ½å®Œå…¨é€šè¿‡ï¼**

### ä¸»è¦æˆå°±:
1. âœ… **ç”¨æˆ·IDå­˜å‚¨**: æ‰€æœ‰æ•°æ®éƒ½æ­£ç¡®å­˜å‚¨åœ¨ç™»å½•ç”¨æˆ·çš„IDä¸‹
2. âœ… **å˜é‡åç§°ä¸€è‡´æ€§**: å‰ç«¯ä¸åç«¯å®Œå…¨å¯¹é½
3. âœ… **æ•°æ®ç±»å‹ç»Ÿä¸€**: æ‰€æœ‰ç”¨æˆ·IDéƒ½æ˜¯ObjectIdç±»å‹
4. âœ… **å­—æ®µå®Œæ•´æ€§**: æ‰€æœ‰å¿…éœ€å­—æ®µéƒ½å·²å­˜åœ¨
5. âœ… **æ•°æ®éš”ç¦»**: ç”¨æˆ·æ•°æ®å®Œå…¨éš”ç¦»ï¼Œæ— äº¤å‰æ±¡æŸ“
6. âœ… **æ€§èƒ½ä¼˜åŒ–**: ç´¢å¼•å’ŒæŸ¥è¯¢ä¼˜åŒ–å®Œæˆ

### æŠ€æœ¯ç‰¹ç‚¹:
- ğŸ” **æ•°æ®å®‰å…¨**: ç”¨æˆ·æ•°æ®å®Œå…¨éš”ç¦»
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: æ™ºèƒ½ç´¢å¼•å’Œæ‰¹é‡å¤„ç†
- ğŸ”„ **å®Œæ•´åŒæ­¥**: æ”¯æŒ9ç§æ•°æ®ç±»å‹çš„åŒå‘åŒæ­¥
- ğŸ“± **ç¦»çº¿æ”¯æŒ**: å®Œæ•´çš„ç¦»çº¿æ“ä½œèƒ½åŠ›
- ğŸ”§ **å†²çªè§£å†³**: æ™ºèƒ½çš„æ•°æ®å†²çªå¤„ç†

### ä¸‹ä¸€æ­¥:
- ğŸš€ å‰ç«¯åº”ç”¨å¯ä»¥å¼€å§‹ä½¿ç”¨åŒæ­¥åŠŸèƒ½
- ğŸ“Š ç›‘æ§åŒæ­¥æ€§èƒ½å’Œé”™è¯¯ç‡
- ğŸ”„ æ ¹æ®ç”¨æˆ·åé¦ˆä¼˜åŒ–åŒæ­¥ç­–ç•¥

---

**éªŒè¯å®Œæˆæ—¶é—´**: 2024å¹´12æœˆ  
**æ•°æ®åº“ç‰ˆæœ¬**: MongoDB Atlas  
**åŒæ­¥æ–¹æ¡ˆç‰ˆæœ¬**: Duolingo Style v1.0  
**éªŒè¯çŠ¶æ€**: âœ… å®Œå…¨é€šè¿‡ 